from cProfile import run
from nemesispy.radtran.calc_tau_gas import calc_tau_gas
import numpy as np
import time
from k_gas_w_g_p_t import k_gas_w_g_p_t

k_gas_w_g_p_t = k_gas_w_g_p_t

P_layer = np.array([134.5171356675359, 219.62124961617837, 358.6647659406711,
    585.9105285122462, 957.6943546371908, 1566.2494053936957, 2562.5251919656494,
    4194.779571701392, 6872.029333294631, 11263.10505748374, 18468.184635789854,
    30300.768159369327, 49750.820966392144, 81772.60292951154, 134538.24509317928,
    221497.9923114219, 364802.3298266832, 600954.5799896372, 990926.8048189385,
    1638243.8142137793])

T_layer = np.array([1436.1021668010171, 1451.8452264810949, 1466.4067793864615,
    1483.601329916745, 1508.2316135840185, 1540.8597711356608, 1582.8215107556534,
    1636.2086482729935, 1698.4712746223586, 1756.19742981913, 1795.0515090572555,
    1802.1217201371387, 1778.5248496622748, 1762.8321009102465, 1792.5747201024908,
    1860.0178153981826, 1962.7619709643411, 2109.316810536133, 2284.1357854227135,
    2428.4297254940307])

VMR_layer = np.array([
    np.array([4.79650e-04, 7.38846e-08, 4.64342e-04, 1.32733e-07, 1.62329e-01,
    8.36727e-01]), np.array([4.79650e-04, 7.38846e-08, 4.64342e-04, 1.32733e-07, 1.62329e-01,
    8.36727e-01]), np.array([4.79650e-04, 7.38846e-08, 4.64342e-04, 1.32733e-07, 1.62329e-01,
    8.36727e-01]), np.array([4.79650e-04, 7.38846e-08, 4.64342e-04, 1.32733e-07, 1.62329e-01,
    8.36727e-01]), np.array([4.79650e-04, 7.38846e-08, 4.64342e-04, 1.32733e-07, 1.62329e-01,
    8.36727e-01]), np.array([4.79650e-04, 7.38846e-08, 4.64342e-04, 1.32733e-07, 1.62329e-01,
    8.36727e-01]), np.array([4.79650e-04, 7.38846e-08, 4.64342e-04, 1.32733e-07, 1.62329e-01,
    8.36727e-01]), np.array([4.79650e-04, 7.38846e-08, 4.64342e-04, 1.32733e-07, 1.62329e-01,
    8.36727e-01]), np.array([4.79650e-04, 7.38846e-08, 4.64342e-04, 1.32733e-07, 1.62329e-01,
    8.36727e-01]), np.array([4.79650e-04, 7.38846e-08, 4.64342e-04, 1.32733e-07, 1.62329e-01,
    8.36727e-01]), np.array([4.79650e-04, 7.38846e-08, 4.64342e-04, 1.32733e-07, 1.62329e-01,
    8.36727e-01]), np.array([4.79650e-04, 7.38846e-08, 4.64342e-04, 1.32733e-07, 1.62329e-01,
    8.36727e-01]), np.array([4.79650e-04, 7.38846e-08, 4.64342e-04, 1.32733e-07, 1.62329e-01,
    8.36727e-01]), np.array([4.79650e-04, 7.38846e-08, 4.64342e-04, 1.32733e-07, 1.62329e-01,
    8.36727e-01]), np.array([4.79650e-04, 7.38846e-08, 4.64342e-04, 1.32733e-07, 1.62329e-01,
    8.36727e-01]), np.array([4.79650e-04, 7.38846e-08, 4.64342e-04, 1.32733e-07, 1.62329e-01,
    8.36727e-01]), np.array([4.79650e-04, 7.38846e-08, 4.64342e-04, 1.32733e-07, 1.62329e-01,
    8.36727e-01]), np.array([4.79650e-04, 7.38846e-08, 4.64342e-04, 1.32733e-07, 1.62329e-01,
    8.36727e-01]), np.array([4.79650e-04, 7.38846e-08, 4.64342e-04, 1.32733e-07, 1.62329e-01,
    8.36727e-01]), np.array([4.79650e-04, 7.38846e-08, 4.64342e-04, 1.32733e-07, 1.62329e-01,
    8.36727e-01])
    ])

U_layer = np.array([3.591069503744629e+26, 5.856921377634588e+26, 9.559150394771109e+26,
    1.561900505129711e+27, 2.5525981549031436e+27, 4.1717723781626874e+27,
    6.828273453349554e+27, 1.1189070139655687e+28, 1.8311589039195442e+28,
    2.997844834720467e+28, 4.913134369808053e+28, 8.064387398210966e+28,
    1.3237891089809454e+29, 2.1741526574606965e+29, 3.583580429644127e+29,
    5.910885289877224e+29, 9.722080657143776e+29, 1.598951578097861e+30,
    2.6331866537901515e+30, 4.337176849975675e+30])

P_grid = np.array([134.5171356675359, 219.62124961617837, 358.6647659406711, 585.9105285122462,
 957.6943546371908, 1566.2494053936957, 2562.5251919656494, 4194.779571701392,
 6872.029333294631, 11263.10505748374, 18468.184635789854, 30300.768159369327,
 49750.820966392144, 81772.60292951154, 134538.24509317928, 221497.9923114219,
 364802.3298266832, 600954.5799896372, 990926.8048189385, 1638243.8142137793])

T_grid = np.array([1222.8229232239096, 1248.9462541255004, 1274.9779870768116, 1304.3038485615368,
 1340.689527384076, 1382.1561869787747, 1424.1391362023737, 1468.3784448494853,
 1524.8943408724024, 1590.6905762091876, 1654.859311331003, 1711.0909373180498,
 1755.243052486764, 1786.2397819640505, 1818.9780602668807, 1874.5347217779104,
 1969.7280357101054, 2112.645634656705, 2284.4337903776427, 2421.9966810953697])

del_g = np.array([0.008807  , 0.02030071, 0.03133602, 0.04163837, 0.05096506,
       0.05909727, 0.06584432, 0.07104805, 0.07458649, 0.07637669,
       0.07637669, 0.07458649, 0.07104805, 0.06584432, 0.05909727,
       0.05096506, 0.04163837, 0.03133602, 0.02030071, 0.008807  ])

tau_w_g_l = calc_tau_gas(k_gas_w_g_p_t, P_layer, T_layer, VMR_layer, U_layer,
    P_grid, T_grid, del_g)

niter = 10000
start = time.time()
for iter in range(niter):
    tau_w_g_l = calc_tau_gas(k_gas_w_g_p_t, P_layer, T_layer, VMR_layer, U_layer,
    P_grid, T_grid, del_g)
end = time.time()
runtime = (end-start)/niter
print('runtime=',runtime)