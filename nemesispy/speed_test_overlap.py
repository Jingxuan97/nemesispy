from nemesispy.radtran.calc_tau_gas import noverlapg
import numpy as np
import time

amount = np.array([0.25,0.25,0.25,0.25])
dg = np.array([0.008807  , 0.02030071, 0.03133602, 0.04163837, 0.05096506,
       0.05909727, 0.06584432, 0.07104805, 0.07458649, 0.07637669,
       0.07637669, 0.07458649, 0.07104805, 0.06584432, 0.05909727,
       0.05096506, 0.04163837, 0.03133602, 0.02030071, 0.008807  ])

opacity = np.array([
 [7.32710493e-03,1.05615874e-02,1.61813826e-02,2.42943521e-02
,3.21097004e-02,3.92757122e-02,4.62392100e-02,5.30516173e-02
,6.04423311e-02,6.90309574e-02,7.99199603e-02,9.32596201e-02
,1.10701718e-01,1.33290187e-01,1.67655808e-01,2.25781979e-01
,3.08841332e-01,4.37374781e-01,6.58927833e-01,1.14324113e+00],
 [3.24375323e-04,7.23196460e-04,1.72324334e-03,3.39416124e-03
,3.81156512e-02,1.21714044e-01,2.80395062e-01,6.74145375e-01
,1.69824544e+00,4.37690241e+00,9.91517340e+00,1.90790452e+01
,3.09170152e+01,4.26609366e+01,5.07691155e+01,5.47644291e+01
,5.72496698e+01,5.95680326e+01,6.25717993e+01,6.60082635e+01],
 [4.10056441e-21,1.11168441e-20,3.47108168e-20,9.59072770e-20
,2.41472485e-19,1.01680645e-18,7.87088150e-04,1.53907296e-01
,5.36187933e-01,7.61079573e-01,1.02990317e+00,1.35581660e+00
,1.75219877e+00,2.30058569e+00,3.10747707e+00,4.27480650e+00
,6.02947939e+00,8.65669825e+00,1.24517737e+01,1.66349590e+01],
 [4.68648958e-03,5.24362168e-03,5.49457018e-03,5.69172261e-03
,5.96828478e-03,6.34667967e-03,6.80111082e-03,7.27749547e-03
,8.06406974e-03,9.32176659e-03,1.08170740e-02,1.25744123e-02
,1.47659057e-02,1.66261790e-02,1.87226255e-02,2.15491909e-02
,2.62366998e-02,3.36308773e-02,4.08914007e-02,5.31105664e-02],
 ])
k_g = noverlapg(k_gas_g=opacity, amount=amount, del_g=dg)
niter = 10000000
start = time.time()
for iter in range(niter):
    k_g = noverlapg(k_gas_g=opacity, amount=amount, del_g=dg)
end = time.time()
runtime = (end-start)/niter
print('runtime=',runtime)